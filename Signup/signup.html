<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Baatly Signup</title>
<link rel="stylesheet" href="../styles.css">
<style>
  .form-wrap { max-width:400px; margin:80px auto; background:#fff; padding:30px; border-radius:12px; box-shadow:0 8px 26px rgba(0,0,0,0.1);}
  input { width:100%; padding:12px; margin:10px 0; border-radius:6px; border:1px solid #ccc; font-size:16px;}
  button { width:100%; padding:12px; margin-top:10px; border:none; border-radius:6px; background:#667eea; color:#fff; font-weight:600; font-size:16px;}
  button:hover{ background:#556cd6;}
  #loading { display:none; text-align:center; margin:10px 0; }
</style>
</head>
<body>

<div class="form-wrap">
  <h2>Create Baatly Account</h2>
  <input type="text" id="name" placeholder="Username">
  <input type="email" id="email" placeholder="Email">
  <input type="password" id="password" placeholder="Password">
  <button id="signupBtn">Signup</button>
  <button id="googleSignupBtn">Signup with Google</button>
  <div id="loading">Creating account...</div>
  <div style="text-align:center;margin-top:12px;">Already have an account? <a href="../Login/login.html">Login</a></div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { getAuth, createUserWithEmailAndPassword, GoogleAuthProvider, signInWithPopup, updateProfile } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";

const firebaseConfig = {
  apiKey: "AIzaSyBHQyKuiAgi831qANOkkWTNprdW1Pq6rbA",
  authDomain: "devchatbyhamad.firebaseapp.com",
  databaseURL: "https://devchatbyhamad-default-rtdb.firebaseio.com",
  projectId: "devchatbyhamad",
  storageBucket: "devchatbyhamad.appspot.com",
  messagingSenderId: "798871184058",
  appId: "1:798871184058:web:c735bea9756f8109149883"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);

const nameEl = document.getElementById('name');
const emailEl = document.getElementById('email');
const passEl = document.getElementById('password');
const signupBtn = document.getElementById('signupBtn');
const googleBtn = document.getElementById('googleSignupBtn');
const loading = document.getElementById('loading');

// Notification function
function notify(msg,type='success'){
  const n=document.createElement('div');
  n.className=`notification ${type}`;
  n.textContent=msg;
  document.body.appendChild(n);
  setTimeout(()=>n.remove(),3000);
}

// Signup with email/password
signupBtn.onclick = async () => {
  loading.style.display='block';
  try{
    const userCred = await createUserWithEmailAndPassword(auth,emailEl.value,passEl.value);
    if(nameEl.value) await updateProfile(userCred.user,{displayName:nameEl.value});
    notify("Signup successful ✅",'success');
    window.location.href="../Chat/chat.html";
  }catch(err){ notify(err.message,'error'); }
  finally{ loading.style.display='none'; }
};

// Signup with Google
googleBtn.onclick = async () => {
  const provider = new GoogleAuthProvider();
  try{
    await signInWithPopup(auth,provider);
    notify("Google signup successful ✅",'success');
    window.location.href="../Chat/chat.html";
  }catch(err){ notify(err.message,'error'); }
};
</script>
</body>
</html>
